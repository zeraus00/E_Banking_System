@using E_BankingSystem.Components.Client_page.Method;
@inject NavigationManager NavigationManager

<div class="d-flex text-light justify-content-start gap-3 mx-5">
    @foreach (var card in Cards)
    {
        <div class="shipping-container d-flex justify-content-between align-items-center p-3 border rounded bg-light gap-3"
             style="cursor: pointer; @(selectedCardId == card.Id ? "border-success" : "")"
             @onclick="() => SelectCard(card.Id)">

            <div>
                <div class="d-flex align-items-center">
                    <img class="logo mx-3" src="@card.LogoUrl" alt="@card.Name Logo" />
                    <div>
                        <h6 class="mb-0">@card.Name</h6>
                    </div>
                </div>
            </div>

            <!-- radio button -->
            @if (transactionProcess)
            {
                <div class="form-check">
                    <input class="form-check-input"
                           type="radio"
                           name="selectedCard"
                           id="@card.Id"
                           value="@card.Id"
                           checked="@((selectedCardId == card.Id))"
                           @onchange="@(() => selectedCardId = card.Id)" />
                    <label class="form-check-label" for="@card.Id"></label>
                </div>
            }
        </div>
    }
</div>

@code {
    private bool transactionProcess = false;
    public int selectedCardId;

    private List<CardModel> Cards = new()
    {
        new CardModel { Id = (int)ExternalVendorIDs.GCASH, Name = "GCash", LogoUrl = "/gcash.png" },
        new CardModel { Id = (int)ExternalVendorIDs.PAYMAYA, Name = "PayMaya", LogoUrl = "/paymaya.jpg" },
        new CardModel { Id = (int)ExternalVendorIDs.GOTYME, Name = "GoTyme", LogoUrl = "/gotyme.png" }
    };

    protected override void OnInitialized()
    {
        // Default select the first card in the list
        selectedCardId = Cards.FirstOrDefault()?.Id ?? 0;

        if (NavigationManager.Uri.Contains("/Withdraw_amount") ||
            NavigationManager.Uri.Contains("/Deposit_amount"))
        {
            transactionProcess = true;
        }
    }

    private void SelectCard(int cardId)
    {
        // Set the selected card ID when a card is clicked
        selectedCardId = cardId;
    }

    public class CardModel
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string LogoUrl { get; set; } = string.Empty;
    }
}
